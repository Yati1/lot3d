function bodyProfile = GenerateBodyProfile( nbStep )
% generate profile of a fly's body shape model
%
%   input:
%       nbStep - steps of profile, 
%
%   output:
%       bodyProfile - 2-by-nbStep, 
%
    BodyLength = 2.7295;%TorsoLength + HeadLength;

    k=4;  
    %------------------------------------------------------------
    torso = [-1.15625, 0;
          -1.15625, 0.050;
          -1.03125, 0.200;
          -0.89675, 0.290;
          -0.75,    0.345;
          -0.620,   0.375;
          -0.50156, 0.425;
          -0.34375, 0.45-0.0125;
          -0.20312, 0.45+0.0125;
          -0.0625,  0.45;
           0.0625,  0.425;
           0.20312, 0.375;
           0.34375, 0.2-0.0125;
           0.48437, 0.375;
           0.625,   0.425;
           0.75,    0.4;
           0.89062, 0.3875;
           1.03125, 0.325;
           1.15625, 0.29;
           1.15625, 0.15
          ];
    %------------------------------------------------------------
    head = [0,0.0004,0.0135,0.0421,0.0790,0.0985,0.1437,0.1992,0.2739,0.2930,0.3555,0.3832,0.4,0.4;
            0.15,0.203, 0.2655,0.2891,0.3019,0.3293,0.3117,0.3105,0.2616,0.2102,0.1524,0.1274,0.0533,0];

    D = [torso' [head(1,:)+ 1.17325; head(2,:)]];
    t = [ zeros(1, k-1) linspace(0,1,numel(D)/2-k+2) ones(1, k-1) ];
    M_body = bspline_deboor(k,t,D);
    %----------------------------------------------------------------
    u = linspace(0,BodyLength,nbStep);
    M_body(1,:) = M_body(1,:) + (u(1)-M_body(1,1));
    
    bodyProfile = M_body;
end